---
title: "Estadística descriptiva y análisis exploratiorio de datos 2021-1\n\nTrabajo grupal 2"
author: "Jeison Durango Cc 1214745706\n\nJoelle Rios Cc 1064978739\n\nDaniela Guardia Cuervo Cc 1007675467"
date: "2021/08/30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE)
```

```{r}
library(readxl)
library(tidyverse)
library(visdat)
library(dlookr)
library(openxlsx)
library(lubridate)
library(ggpubr)
library(kableExtra)
library(hrbrthemes)
library(viridis)
```

```{r}
## Lectura de una base de datos tipo ".csv"
bdInternet <- read.csv("BD_Completa.csv", encoding = "UTF-8")

bdInternet <- bdInternet %>%
  mutate(TEST_DATE = as.POSIXct(strptime(TEST_DATE, "%m/%d/%Y %H:%M:%S")))

bdInternet <- bdInternet %>%
  mutate(TEST_HOUR = ifelse(format(TEST_DATE, format = "%H") %in% c("08", "09"), 9,
                            ifelse(format(TEST_DATE, format = "%H") %in% c("13", "14"), 14, 19)))
```

```{r}
tempLatencia <- bdInternet %>%
  select(TEMPERATURE, LATENCY_MS)

plot_correlate(tempLatencia)
```

```{r}
tempLatencia %>%
  group_by(LATENCY_MS) %>%
  summarise(media = mean(TEMPERATURE)) %>%
  plot(type = "l")
```
```{r}
propVelocidades <- bdInternet %>%
  mutate(PROPORTION = DOWNLOAD_INDICATOR/UPLOAD_INDICATOR) %>%
  select(TEST_HOUR, PROPORTION)
```

```{r}
propVelocidades %>%
  filter(TEST_HOUR == 9) %>%
  ggplot(aes(x=TEST_HOUR,
             y=PROPORTION,
             fill=TEST_HOUR)) +
    geom_boxplot() +
    scale_fill_viridis(discrete = F, alpha=0.6, option="A") +
    theme_ipsum() +
    theme(#legend.position="none",
          plot.title = element_text(size=11),
          axis.text.x = element_text(angle = 50, vjust = 0.5, hjust=1)) +
    ggtitle("Diagrama de cajas y bigotes. Tiempo de recuperación menor a 30 días.") +
    xlab("") + ylab("Tiempo de recuperación (días)")
```






